#include <stdio.h>
#include <string.h>
#include "od.h"
#include "kl_aes.h"

/*!
 * Encryption aBlock and sBlock
 */
static uint8_t aBlock[] = {0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                           0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static uint8_t sBlock[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                           0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static uint8_t Key[] = {0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                        0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static uint8_t en_in_data[] = {
    0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7,
    0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,
    0x11, 0x12, 0x13, 0x14, 0x15};

uint8_t en_out_data[40];
uint8_t de_out_data[40];

int main(void)
{
    uint32_t len = sizeof(en_in_data);

    kl_aes_encrypt(en_in_data, len, Key, aBlock, sBlock, en_out_data);
    printf("encrypt :\r\n");
    od_hex_dump(en_out_data, len, 0);

    kl_aes_decrypt(en_out_data, len, Key, aBlock, sBlock, de_out_data);
    printf("decrypt :\r\n");
    od_hex_dump(de_out_data, len, 0);

    return 0;
}
